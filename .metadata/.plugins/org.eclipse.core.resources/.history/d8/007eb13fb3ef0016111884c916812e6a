package mongodb;

import com.mongodb.MongoClient;
import com.mongodb.DB;
import com.mongodb.DBCollection;
import com.mongodb.BasicDBObject;
import com.mongodb.DBCursor;

import java.util.Date;

public class MykyongTutorial {

	public static void main(String[] args) {
		
		//This is to connect to a MongoDB server
		MongoClient mongo = new MongoClient("localhost",27017);
		
		DB db = mongo.getDB("kyongdata");
		
		//A DBCollection is a table within a database, a database
		//can contain several tables
		DBCollection table = db.getCollection("demotable");
		
		//This is a document object
		BasicDBObject document = new BasicDBObject();
		
		/*
		
		document.put("name","yasser");
		document.put("lastname","palacios");
		document.put("age",41);
		document.put("createdDate",new Date());
		table.insert(document);
		
		
		document.put("name","heidi");
		document.put("lastname","palacios");
		document.put("age",41);
		document.put("createdDate",new Date());
		table.insert(document);
		
		*/
		//This is to query the table and look for a records with ages of 41
		BasicDBObject query = new BasicDBObject();
		query.put("age",41);
		DBCursor cursor = table.find(query);
		
		while(cursor.hasNext()){
			System.out.println(cursor.next());
		}
		
		
		/*
		
		//This is to update Heidi's name
		BasicDBObject query2 = new BasicDBObject();
		query2.put("name","heidi");
		
		BasicDBObject newDocument = new BasicDBObject();
		newDocument.put("name","catherine");
		
		BasicDBObject updateObj = new BasicDBObject();
		updateObj.put("$set",newDocument);
		
		table.update(query2, updateObj);
		
	
		*/
		
		BasicDBObject query3 = new BasicDBObject();
		query3.put("age",41);
		DBCursor cursor2 = table.find(query);
		
	
		
		while(cursor2.hasNext()){
			System.out.println(cursor2.next());
		}

	}

}
